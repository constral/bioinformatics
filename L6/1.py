import random
import math
from pathlib import Path
import numpy as np
import matplotlib.pyplot as plt

# -----------------------------
# 1) Sample DNA (edit as needed)
# -----------------------------
SAMPLE_DNA = "TAGCATGAGTGCGTCATTCCGCATGAGTGCGTCATTCCGCATGAGTGCGTCATTCCGTGTGGAGCGCCATAATCATCACCGGCTTCGGATGTTGGACGGGGCGGGAGAGTGCTCGTAGTAATCCAATGAGAAAGTCACGCGCCAGGTTGGCTGAAGCTCGTAGTAATCCAATGAGAAAGTCACGCGCCAGGTTGGCTGAAGCTCGTAGTAATCCAATGAGAAAGTCACGCGCCAGGTTGGCTGAAGCCAGTAACACTTAGCACCAGTAACACTTAGCACCAGTAACACTTAGCACCAGTAACACTTAGCACCAGTAACACTTAGCACCAGTAACACTTAGCACCAGTAACACTTAGCACCAGTAACACTTAGCACCAGTAACACTTAGCACCAGTAACACTTAGCAAACATGAAGTTACCTTGGCGTAACGAACGGATAGGGATGGGGTGCGGTTCTCGATCAGCCAGGTTGCGGGTGCACTTTTGCGGGATGGGGTGCGGTTCTCGATCAGCCAGGTTGCGGGTGCACTTTTGCGGGATGGGGTGCGGTTCTCGATCAGCCAGGTTGCGGGTGCACTTTTGCAAATTCACATCATAGGCTCCATTCACATCATAGGCTCCAGTTTTGTGATCCTCAAGCATTGTGATTGGTCACCTTACATAAGAGTTTTGTGATCCTCAAGCATTGTGATTGGTCACCTTACATAAGAGAGAACAACGCACCATTCGATGATCGCCCGCGGATAATAACAACGCACCATTCGATGATCGCCCGCGGATAATAACAACGCACCATTCGATGATCGCCCGCGGATAATAACAACGCACCATTCGATGATCGCCCGCGGATAATAACAACGCACCATTCGATGATCGCCCGCGGATAATAACAACGCACCATTCGATGATCGCCCGCGGATAATAACAACGCACCATTCGATGATCGCCCGCGGATAATAACAACGCACCATTCGATGATCGCCCGCGGATAATGCGGGAACAAGGCTGAGGACACCGTGGAACCTGCTGCTGGTCCCGGAAGCCTAGTGGAACCTGCTGCTGGTCCCGGAAGCCTAGTGGAACCTGCTGCTGGTCCCGGAAGCCTAGTGGAACCTGCTGCTGGTCCCGGAAGCCTAGTGGAACCTGCTGCTGGTCCCGGAAGCCTAGTGGAACCTGCTGCTGGTCCCGGAAGCCTAGTGGAACCTGCTGCTGGTCCCGGAAGCCTAGGTGCGAACGCGCGGCGTGGTTGGTGTGGCGGATAAAACAGCACCCAGCATCTGTTGTCGATGGCGGATAAAACAGCACCCAGCATCTGTTGTCGATGGCGGATAAAACAGCACCCAGCATCTGTTGTCGATGGCGGATAAAACAGCACCCAGCATCTGTTGTCGATGGCGGATAAAACAGCACCCAGCATCTGTTGTCGATGGCGGATAAAACAGCACCCAGCATCTGTTGTCGATGGCGGATAAAACAGCACCCAGCATCTGTTGTCGATAATCGACCCTGTCGCCCTTCGCGATAGATTGGGGGTGAGCACCTTGAGTAGAGCTCGCCCTTCGCGATAGATTGGGGGTGAGCACCTTGAGTAGAGCTCGCCCTTCGCGATAGATTGGGGGTGAGCACCTTGAGTAGAGCTCGCCCTTCGCGATAGATTGGGGGTGAGCACCTTGAGTAGAGCTCGCCCTTCGCGATAGATTGGGGGTGAGCACCTTGAGTAGAGCCACATTACAGGTCCTGCTCGGTAGTACCACATTACAGGTCCTGCTCGGTAGTACCACATTACAGGTCCTGCTCGGTAGTACCACATTACAGGTCCTGCTCGGTAGTACCACATTACAGGTCCTGCTCGGTAGTACCACATTACAGGTCCTGCTCGGTAGTACCACATTACAGGTCCTGCTCGGTAGTACCAAGCCGTTCAGGAGCATTATATCTAAAGCCGTTCAGGAGCATTATATCTAAAGCCGTTCAGGAGCATTATATCTATATCAGCCCATGCCCCGAGCTAGGTTATATATGGTCTAGGGCAATCTACATCATATTAACAGCCCCGCATGATGATTTCGGTCTAGGGCAATCTACATCATATTAACAGCCCCGCATGATGATTTCGGTCTAGGGCAATCTACATCATATTAACAGCCCCGCATGATGATTTCGGTCTAGGGCAATCTACATCATATTAACAGCCCCGCATGATGATTTCGGTCTAGGGCAATCTACATCATATTAACAGCCCCGCATGATGATTTCGGTCTAGGGCAATCTACATCATATTAACAGCCCCGCATGATGATTTCGGTCGGGGCGCTTTTTCCCGAGAAGTATTGCTTTACTCCATGTGGGGCATATAGGGCGCTTTTTCCCGAGAAGTATTGCTTTACTCCATGTGGGGCATATAGGGCGCTTTTTCCCGAGAAGTATTGCTTTACTCCATGTGGGGCATATAGGGCGCTTTTTCCCGAGAAGTATTGCTTTACTCCATGTGGGGCATATAGGGCGCTTTTTCCCGAGAAGTATTGCTTTACTCCATGTGGGGCATATAACAAAGCGCAGAAAGCGCAGAAAGCGCAGAAAGCGCAGAAAGCGCAGAGCCCAATCATATGTCCGCCCCCGCAGTTACCGCCTACAACTGTCCGCCCCCGCAGTTACCGCCTACAACTGTCCGCCCCCGCAGTTACCGCCTACAACTGTCCGCCCCCGCAGTTACCGCCTACAACTGTCCGCCCCCGCAGTTACCGCCTACAACTGTCCGCCCCCGCAGTTACCGCCTACAACTGTCCGCCCCCGCAGTTACCGCCTACATACTTCAATGGGAGACTGAATCTAGCCACGTCGCTCTAGCCCTACTGTACCAAGACCGGTCGATTCTAGCCACGTCGCTCTAGCCCTACTGTACCAAGACCGGTCGATTCTAGCCACGTCGCTCTAGCCCTACTGTACCAAGACCGGTCGATTCTAGCCACGTCGCTCTAGCCCTACTGTACCAAGACCGGTCGATTCTAGCCACGTCGCTCTAGCCCTACTGTACCAAGACCGGTCGATTCTAGCCACGTCGCTCTAGCCCTACTGTACCAAGACCGGTCGATTCTAGCCACGTCGCTCTAGCCCTACTGTACCAAGACCGGTCGATTCTAGCCACGTCGCTCTAGCCCTACTGTACCAAGACCGGTCGATTCTAGCCACGTCGCTCTAGCCCTACTGTACCAAGACCGGTCGATTCTAGCCACGTCGCTCTAGCCCTACTGTACCAAGACCGGTCGATCTTTAATATCTATAAACCACCCATTAAAACCACCCATTAAAACCACCCATTAAAACCACCCATTACGTAGACGTAATCCAGTCACTATAGATCGAGAACAGTATACTTTCCTATTCTATCCAGTCACTATAGATCGAGAACAGTATACTTTCCTATTCTATCCAGTCACTATAGATCGAGAACAGTATACTTTCCTATTCTATCCAGTCACTATAGATCGAGAACAGTATACTTTCCTATTCTATCCAGTCACTATAGATCGAGAACAGTATACTTTCCTATTCTCGCGTCTGAAACCCCAGGTGTTGGGGCGTCTGAAACCCCAGGTGTTGGGGCGTCTGAAACCCCAGGTGTTGGGGCGTCTGAAACCCCAGGTGTTGGGCATCGGGCACACTGCAAATTCTAGCGACTGTTGCAAGATCGAGCGTCGGGCACACTGCAAATTCTAGCGACTGTTGCAAGATCGAGCGTCGGGCACACTGCAAATTCTAGCGACTGTTGCAAGATCGAGCGTCGGGCACACTGCAAATTCTAGCGACTGTTGCAAGATCGAGCGTCGGGCACACTGCAAATTCTAGCGACTGTTGCAAGATCGAGCGTTTGGCCCATGCAATGCCCATGCAATGCCCATGCAATGCCCATGCAATGCCCATGCAATTCTCCAGCTTAAATGAAGCCAACCTCAAGTGTTACAGCTTAAATGAAGCCAACCTCAAGTGTTACAGCTTAAATGAAGCCAACCTCAAGTGTTACAGCTTAAATGAAGCCAACCTCAAGTGTTACAGCTTAAATGAAGCCAACCTCAAGTGTTACAGCTTAAATGAAGCCAACCTCAAGTGTTATGATAACCATAACCATAACCATAACCATAACCATAACCATAACCACACTTGTGACCGCTTGTCGGTATCTCGACAGAAATGAGCCTCCGCGCCACCGCTTGTCGGTATCTCGACAGAAATGAGCCTCCGCGCCACCGCTTGTCGGTATCTCGACAGAAATGAGCCTCCGCGCCACCGCTTGTCGGTATCTCGACAGAAATGAGCCTCCGCGCCACCGCTTGTCGGTATCTCGACAGAAATGAGCCTCCGCGCCACCGCTTGTCGGTATCTCGACAGAAATGAGCCTCCGCGCCACCGCTTGTCGGTATCTCGACAGAAATGAGCCTCCGCGCCAGCGGAGTACCGGAGACTGCGTCGGTAAGACTGACACCGACGTATTTTAGCGGAGTACCGGAGACTGCGTCGGTAAGACTGACACCGACGTATTTTAGCGGAGTACCGGAGACTGCGTCGGTAAGACTGACACCGACGTATTTTAGCGGAGTACCGGAGACTGCGTCGGTAAGACTGACACCGACGTATTTTAGCGGAGTACCGGAGACTGCGTCGGTAAGACTGACACCGACGTATTTTAGCGGAGTACCGGAGACTGCGTCGGTAAGACTGACACCGACGTATTTTAGCGGAGTACCGGAGACTGCGTCGGTAAGACTGACACCGACGTATTTTAGCGGAGTACCGGAGACTGCGTCGGTAAGACTGACACCGACGTATTTTAGACATTCCTGTTCATTCCTGTTCATTCCTGTTCATTCCTGTTCATTCCTGTTCATTCCTGTTCATTCCTGTTCATTCCTGTTATTCTCACTCTTGGATATAATAGGGAGGAATCCTTGCATACGACGTCCAATCCTTGCATACGACGTCCAATCCTTGCATACGACGTCCAATCCTTGCATACGACGTCCAATCCTTGCATACGACGTCCAATCCTTGCATACGACGTCCAATCCTTGCATACGACGTCCAATCCTTGCATACGACGTCCAATCCTTGCATACGACGTCCAGACCATCGGTCGGCACGTCGACCATCGGTCGGCACGTCGACCATCGGTCGGCACGTCGACCATCGGTCGGCACGTCGGAGTTGTAGATACCGAGGGGAACTGGCTAAGTCCAGAGTTAGGAGGGGAACTGGCTAAGTCCAGAGTTAGGAGGGGAACTGGCTAAGTCCAGAGTTAGGAGGGGAACTGGCTAAGTCCAGAGTTAGGAGGGGAACTGGCTAAGTCCAGAGTTAGGAGGGGAACTGGCTAAGTCCAGAGTTAGGAGGGGAACTGGCTAAGTCCAGAGTTAGGAGGGGAACTGGCTAAGTCCAGAGTTAGGAGGGGAACTGGCTAAGTCCAGAGTTAGGAGGGGAACTGGCTAAGTCCAGAGTTAGGTATCGATGCGATACAAGCTTAAAAAGAAAACTTTCCAGGTAACATGCATGCGATACAAGCTTAAAAAGAAAACTTTCCAGGTAACATGCATGCGATACAAGCTTAAAAAGAAAACTTTCCAGGTAACATGCATGCGATACAAGCTTAAAAAGAAAACTTTCCAGGTAACATGCATGCGATACAAGCTTAAAAAGAAAACTTTCCAGGTAACATGCATGCGATACAAGCTTAAAAAGAAAACTTTCCAGGTAACATGCATGCGATACAAGCTTAAAAAGAAAACTTTCCAGGTAACATGCATGCGATACAAGCTTAAAAAGAAAACTTTCCAGGTAACATGCGTAACAATAATTGCCAAAGGATAAGGATAAGGATAAGGATAAGGATAAGGATGATTACGTGGCATAAAGCGCGTAACACCTTCGTAGCGTAACACCTTCGTAGCGTAACACCTTCGTAGCGTAACACCTTCGTAGCGTAACACCTTCGTAGCGTAACACCTTCGTAGCGTAACACCTTCGTAGCGTAACACCTTCGTAGCGTAACACCTTCGTATACGGCAAGTAGAGTTACCGTTGTGGCCTCGTCGGTCGTCCATGTGGCCTCGTCGGTCGTCCATGTGGCCTCGTCGGTCGTCCATGTGGCCTCGTCGGTCGTCCATGTGGCCTCGTCGGTCGTCCATTCGTCATCCTCAGCGTGTACCATACAGGCGGTGTCGCTAGGTGAAAAGGTCACATTGGAGGGATTCATGGTGATTCCATGTCGCTAGGTGAAAAGGTCACATTGGAGGGATTCATGGTGATTCCATGTCGCTAGGTGAAAAGGTCACATTGGAGGGATTCATGGTGATTCCATGTCGCTAGGTGAAAAGGTCACATTGGAGGGATTCATGGTGATTCCATGTCGCTAGGTGAAAAGGTCACATTGGAGGGATTCATGGTGATTCCATGTCGCTAGGTGAAAAGGTCACATTGGAGGGATTCATGGTGATTCCATGTCGCTAGGTGAAAAGGTCACATTGGAGGGATTCATGGTGATTCCATGTCGCTAGGTGAAAAGGTCACATTGGAGGGATTCATGGTGATTCCATGTCGCTAGGTGAAAAGGTCACATTGGAGGGATTCATGGTGATTCCAGATAAATCAGCGTAGGGAGGAATTTTGAACGTTGGCATATCCCGACGTCGCTAGTAGCGTAGGGAGGAATTTTGAACGTTGGCATATCCCGACGTCGCTAGTAGCGTAGGGAGGAATTTTGAACGTTGGCATATCCCGACGTCGCTAGTAGCGTAGGGAGGAATTTTGAACGTTGGCATATCCCGACGTCGCTAGTAGCGTAGGGAGGAATTTTGAACGTTGGCATATCCCGACGTCGCTAGTCCATGTGTTGCGATGTGCATGTGTTGCGATGTGCATGTGTTGCGATGTGCCGGGAGGATCCCGTCATTCTGAGCTGTGGCATGCAATCAAGATGGAGGAGGATCCCGTCATTCTGAGCTGTGGCATGCAATCAAGATGGAGGAGGATCCCGTCATTCTGAGCTGTGGCATGCAATCAAGATGGAGGAGGATCCCGTCATTCTGAGCTGTGGCATGCAATCAAGATGGAGGAGGATCCCGTCATTCTGAGCTGTGGCATGCAATCAAGATGGAGGAGGATCCCGTCATTCTGAGCTGTGGCATGCAATCAAGATGGAGGAGGATCCCGTCATTCTGAGCTGTGGCATGCAATCAAGATGGAGGAGGATCCCGTCATTCTGAGCTGTGGCATGCAATCAAGATGGAAGTTGGTCCTCAAACGGAAGTTGGTCCTCAAACGGAAGTTGGTCCTCAAACGGAAGTTGGTCCTCAAACGGAAGTTGGTCCTCAAACGGAAGTTGGTCCTCAAACGGAAGTTGGTCCTCAAACGGAAGTTGGTCCTCAAACGGAAGTTGGTCCTCAAACGGAAGAAACTAAAGAAATGCCCCTAGGTCATTGGAACTTCATTTGATAATGATAGCTGCTAAAGAAATGCCCCTAGGTCATTGGAACTTCATTTGATAATGATAGCTGAAGTGGTCACGCTACCTAGGGTTCTCCATGGTGATAATCGCCCTAGGTTCAAGAGGCTCAAACGCGCCGTGATAATCGCCCTAGGTTCAAGAGGCTCAAACGCGCCGTGATAATCGCCCTAGGTTCAAGAGGCTCAAACGCGCCGTGATAATCGCCCTAGGTTCAAGAGGCTCAAACGCGCCGTGATAATCGCCCTAGGTTCAAGAGGCTCAAACGCGCCGTGATAATCGCCCTAGGTTCAAGAGGCTCAAACGCGCCGTGATAATCGCCCTAGGTTCAAGAGGCTCAAACGCGCCGGATCGCAATAAAACGTTCCGGCTATACCGCAATAAAACGTTCCGGCTATACCGCAATAAAACGTTCCGGCTATACCGCAATAAAACGTTCCGGCTATACCGCAATAAAACGTTCCGGCTATACCGCAATAAAACGTTCCGGCTATACCGCAATAAAACGTTCCGGCTATACCCGGGCAAATCAGCATTTAATCAGCATTTAATCAGCATTTAATCAGCATTTAATCAGCATTTGTCTGAACGCCAGTCCCTTGGTGGCATCATGTAAGAGAGGTACCTAGCCTTGGTGGCATCATGTAAGAGAGGTACCTAGCCTTGGTGGCATCATGTAAGAGAGGTACCTAGCCTTGGTGGCATCATGTAAGAGAGGTACCTAGCCTTGGTGGCATCATGTAAGAGAGGTACCTAGCCTTGGTGGCATCATGTAAGAGAGGTACCTAGTAACGTGTGTCCACCGTAGGCCCAAGAAGTAATCCCGCGATCCAAGGTGTCCACCGTAGGCCCAAGAAGTAATCCCGCGATCCAAGGTGTCCACCGTAGGCCCAAGAAGTAATCCCGCGATCCAAGGTGTCCACCGTAGGCCCAAGAAGTAATCCCGCGATCCAAGGTGTCCACCGTAGGCCCAAGAAGTAATCCCGCGATCCAAGTGCGATAGCCCAACCCACGATCGGAGGTGCTACCAACCCACGATCGGAGGTGCTACCAACCCACGATCGGAGGTGCTACCAACCCACGATCGGAGGTGCTAAGCGTATTTAAGGAGTCCTCAGCAGATGGCGTCCTACAGATTAATGGCGTCCTACAGATTAATGGCGTCCTACAGATTAGTATCGAAGTCGGCGTTGATATCCGTATCGATCGAAGTCGGCGTTGATATCCGTATCGCGTCGGAGCACCGCCGAAGAACATCGGGAGCACCGCCGAAGAACATCGGGAGCACCGCCGAAGAACATCGGGAGCACCGCCGAAGAACATCGGGAGCACCGCCGAAGAACATCGGGAGCACCGCCGAAGAACATCGGGAGCACCGCCGAAGAACATCGGGAGCACCGCCGAAGAACATCGGGAGCACCGCCGAAGAACATCGAGAAGATATGGATATGGATATGGATATGGATATGGATATGGATATGGATATGGATATGGATATGCTCGGCATTGCAACGGGGCATTGCAACGGGGCATTGCAACGGGGCATTGCAACGGGGCATTGCAACGGGGCATTGCAACGGGGCATTGCAACGGGGCATTGCAACGGGGCATTGCAACGGTTCGGTTTACCTGTGAGTGCCCTGTGAGTGCCCTGTGAGTGCCCTGTGAGTGCCCTGTGAGTGCCCTGTGAGTGCCCTGTGAGTGCCCTGTGAGTGCCCTGTGAGTGCATTTCCAGCTATTTCCAGCTATTTCCAGCTATTTCCAGCTATTTCCAGCTACCCGCAAACGCTTATATGCGGTCTGTATCCCGCAAACGCTTATATGCGGTCTGTATCCCGCAAACGCTTATATGCGGTCTGTATCCCGCAAACGCTTATATGCGGTCTGTATGGGAGGAACTAAACCGGGCTATTCTGATAAGCATTATTGGAGGAACTAAACCGGGCTATTCTGATAAGCATTATTGGAGGAACTAAACCGGGCTATTCTGATAAGCATTATTAGGAAAGGCTACACCGCGTAATGGCAGTGTAGAGATGAGACACGCTAACAACCCTATTACTCGTAAGTGGCCTTGCACCCTATTACTCGTAAGTGGCCTTGCACCCTATTACTCGTAAGTGGCCTTGCACCCTATTACTCGTAAGTGGCCTTGCACCCTATTACTCGTAAGTGGCCTTGCAATCAGTAAGAGTAAGAGTAAGAGTAAGAGTAAGAGTAAGAATGTCGGGAGCAAATGGTAGTCTCATGCTCAAGCGGATAATCCTCGGAAGGATGCTCAAGCGGATAATCCTCGGAAGGTTACTAGTGCCCTTTATTTGTCTCTTAGGCACGCCGCGCGTTGGCACGTGAGGGGAGTTCAATGGTTTGTTCGCTCGATATAACCGGCGTTGGCACGTGAGGGGAGTTCAATGGTTTGTTCGCTCGATATAACCGGCGTTGGCACGTGAGGGGAGTTCAATGGTTTGTTCGCTCGATATAACCGGCGTTGGCACGTGAGGGGAGTTCAATGGTTTGTTCGCTCGATATAACCGGCGTTGGCACGTGAGGGGAGTTCAATGGTTTGTTCGCTCGATATAACCGGCGTTGGCACGTGAGGGGAGTTCAATGGTTTGTTCGCTCGATATAACCGGCGTTGGCACGTGAGGGGAGTTCAATGGTTTGTTCGCTCGATATAACCGGCGTTGGCACGTGAGGGGAGTTCAATGGTTTGTTCGCTCGATATAACCGGCGTTGGCACGTGAGGGGAGTTCAATGGTTTGTTCGCTCGATATAACCGGCGTTGGCACGTGAGGGGAGTTCAATGGTTTGTTCGCTCGATATAACCGTGCTTCTACGCACGTATTCCTATTTTATCACACTTGGATGGCTGCCACGTATTCCTATTTTATCACACTTGGATGGCTGCCACGTATTCCTATTTTATCACACTTGGATGGCTGCCACGTATTCCTATTTTATCACACTTGGATGGCTGCCACGTATTCCTATTTTATCACACTTGGATGGCTGCCACGTATTCCTATTTTATCACACTTGGATGGCTGCCACGTATTCCTATTTTATCACACTTGGATGGCTGCACAGACCATGTGTCATGTGTCATGTGTCATGTGTCATTGGATCATATAACTCCGGGTGGATCATATAACTCCGGGTGGATCATATAACTCCGGGAAGGAAAACACGCCCCGTCAGCTAAACACGCCCCGTCAGCTCGCCTTGCACCGCATTCTAGCCAGTGCCTTGCACCGCATTCTAGCCAGTGCCTTGCACCGCATTCTAGCCAGTGCCTTGCACCGCATTCTAGCCAGTTCAGAAGTAACGAGAGAAGACATGTTCTAGCGGGAACTGCGAAGTAACGAGAGAAGACATGTTCTAGCGGGAACTGCGAAGTAACGAGAGAAGACATGTTCTAGCGGGAACTGCCGGGTGTATAGAACACACGGATATCAGGCCCCCCTCGACAACACGCGTGTATAGAACACACGGATATCAGGCCCCCCTCGACAACACGCGTGTATAGAACACACGGATATCAGGCCCCCCTCGACAACACGCGTGTATAGAACACACGGATATCAGGCCCCCCTCGACAACACGCATGTTGTCTTAGCCCATCAAACGGCCTTGTCAAGCGGCGATATAGCCCATCAAACGGCCTTGTCAAGCGGCGATATAGCCCATCAAACGGCCTTGTCAAGCGGCGATATAGCCCATCAAACGGCCTTGTCAAGCGGCGATATAGCCCATCAAACGGCCTTGTCAAGCGGCGATATAGCCCATCAAACGGCCTTGTCAAGCGGCGATATAGCCCATCAAACGGCCTTGTCAAGCGGCGATAAAAGCCCGGTTCCTGGCGTGCCTTGGTAGAAAGGCGTCCGATATCATCTCACTAACCGGTTCCTGGCGTGCCTTGGTAGAAAGGCGTCCGATATCATCTCACTAACCGGTTCCTGGCGTGCCTTGGTAGAAAGGCGTCCGATATCATCTCACTAACCGGTTCCTGGCGTGCCTTGGTAGAAAGGCGTCCGATATCATCTCACTAACCGGTTCCTGGCGTGCCTTGGTAGAAAGGCGTCCGATATCATCTCACTAACCGGTTCCTGGCGTGCCTTGGTAGAAAGGCGTCCGATATCATCTCACTAAATGCCCACTGGGGTGAATCGCACCCTATTCGTGCACCCTATTCGTGCACCCTATTCGTGCACCCTATTCGTGCACCCTATTCGTGCACCCTATTCGTGCACCCTATTCGTTGACTGTCGCCTGTATTTGTACGCCTGTATTTGTACGCCTGTATTTGTACGCCTGTATTTGTACGCCTGTATTTGTACGCCTGTATTTGTACGCCTGTATTTGTACGCCTGTATTTGTACGCCTGTATTTGTATTAGACATAATTTGTACGATTCTCTATTGAAGTCATATCTAGAGTCAGTCCGCTTAAGTACAGTCCGCTTAAGTATTTTCTCCTATCGGACGTATAACAAATCCACGCCATCCCGGGTCCCGTTGTCCAAGTCAATA"
# Repeat to ensure long enough; replace SAMPLE_DNA with your full sequence.


# -----------------------------
# 2) & 3) Take 10 random samples (100-3000 bp) and store in list `samples`
# -----------------------------
NUM_SAMPLES = 10
MIN_LEN = 100
MAX_LEN = 3000

seq = SAMPLE_DNA.upper()
seq_len = len(seq)
samples = []
random.seed(42)  # remove or change seed if you want non-reproducible picks

for _ in range(NUM_SAMPLES):
    L = random.randint(MIN_LEN, MAX_LEN)
    if L > seq_len:
        L = seq_len
    start = random.randint(0, max(0, seq_len - L))
    samples.append(seq[start : start + L])

# -----------------------------
# 4) Compute molecular weight (approx) and map length -> migration
# -----------------------------
# Approx: 660 Da per base pair (double-stranded)
mw_per_bp = 660.0
lengths = [len(s) for s in samples]
mws = [int(l * mw_per_bp) for l in lengths]

# Map length -> normalized migration (0 = top/short travel, 1 = bottom/furthest)
# using log scale because mobility ~ inverse log(fragment size)
log_lengths = [math.log10(max(1, l)) for l in lengths]
min_log, max_log = min(log_lengths), max(log_lengths)

def length_to_norm_migration(length_bp):
    lg = math.log10(max(1, length_bp))
    if max_log == min_log:
        return 0.5
    # smaller length -> larger migration (closer to 1)
    return (max_log - lg) / (max_log - min_log)

norm_migrations = [length_to_norm_migration(l) for l in lengths]

# -----------------------------
# Visualization: gel-like plot
# -----------------------------
plt.figure(figsize=(8, 2 + 0.4 * NUM_SAMPLES))
ax = plt.gca()
ax.set_xlim(0, 1)
ax.set_ylim(0, 1)
ax.axis('off')

left_margin = 0.08
right_margin = 0.92
top_margin = 0.95
bottom_margin = 0.05
gel_w = right_margin - left_margin
gel_h = top_margin - bottom_margin

# faint gel background
ax.add_patch(plt.Rectangle((left_margin, bottom_margin), gel_w, gel_h, alpha=0.06))

lane_xs = np.linspace(left_margin + 0.03, right_margin - 0.03, NUM_SAMPLES)

for i, (x, norm, L) in enumerate(zip(lane_xs, norm_migrations, lengths), start=1):
    # lane
    ax.plot([x, x], [bottom_margin, top_margin], linewidth=0.8)
    # band horizontal segment (use plot to allow solid_capstyle)
    y = top_margin - norm * gel_h
    ax.plot([x - 0.03, x + 0.03], [y, y], linewidth=6, solid_capstyle='butt')
    ax.text(x, bottom_margin - 0.03, f"{i}\n{L} bp", ha='center', va='top', fontsize=8)

# scale ticks (representative sizes)
tick_candidates = [100, 250, 500, 1000, 2000, 3000]
tick_lengths = [t for t in tick_candidates if min(lengths) <= t <= max(lengths)]
for t in tick_lengths:
    y = top_margin - length_to_norm_migration(t) * gel_h
    ax.text(right_margin + 0.02, y, f"{t} bp", va='center', fontsize=8)

ax.set_title("Simulated electrophoresis gel â€” random fragments", fontsize=10)
plt.tight_layout()
plt.show()

# -----------------------------
# Additional plot: length vs normalized migration
# -----------------------------
plt.figure(figsize=(7,3))
plt.scatter(lengths, norm_migrations)
plt.xscale('log')
plt.xlabel("Fragment length (bp) [log scale]")
plt.ylabel("Normalized migration (0 top -> 1 bottom)")
plt.title("Fragment length vs simulated migration")
plt.grid(True, linestyle=':', linewidth=0.5)
for i, (L, m) in enumerate(zip(lengths, norm_migrations), start=1):
    plt.text(L, m + 0.02, str(i), ha='center', fontsize=8)
plt.tight_layout()
plt.show()

# -----------------------------
# Console summary
# -----------------------------
print("Index : length (bp) : approx MW (Da) : normalized_migration")
for i, (L, MW, M) in enumerate(zip(lengths, mws, norm_migrations), start=1):
    print(f"{i:2d} : {L:5d} bp : {MW:10,d} Da : {M:.3f}")
